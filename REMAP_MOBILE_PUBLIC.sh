#!/bin/bash

# æ‰‹æœºç«¯å…¬ç½‘é‡æ–°æ˜ å°„è„šæœ¬
# ç”¨äºŽå°†æœ€æ–°çš„æ‰‹æœºç«¯æž„å»ºéƒ¨ç½²åˆ°Sealoså…¬ç½‘

echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘                                                               â•‘"
echo "â•‘         æ‰‹æœºç«¯å…¬ç½‘é‡æ–°æ˜ å°„è„šæœ¬                               â•‘"
echo "â•‘                                                               â•‘"
echo "â•‘    è¯¥è„šæœ¬å°†å¸®åŠ©ä½ é‡æ–°éƒ¨ç½²æœ€æ–°çš„æ‰‹æœºç«¯åˆ°Sealoså…¬ç½‘           â•‘"
echo "â•‘                                                               â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo

# é¢œè‰²å®šä¹‰
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

# ç¡®ä¿æˆ‘ä»¬åœ¨é¡¹ç›®æ ¹ç›®å½•
cd /home/devbox/project

echo -e "${BLUE}ðŸ“‹ æ£€æŸ¥æž„å»ºæ–‡ä»¶...${NC}"
echo

# æ£€æŸ¥æ‰‹æœºç«¯dist
if [ -f "mobile/dist/index.html" ] && [ -d "mobile/dist/assets" ]; then
    echo -e "${GREEN}âœ… æ‰‹æœºç«¯distæ–‡ä»¶å®Œæ•´${NC}"
    MOBILE_SIZE=$(du -sh mobile/dist/ | cut -f1)
    echo "   å¤§å°: $MOBILE_SIZE"
    echo "   è·¯å¾„: $(pwd)/mobile/dist/"
else
    echo -e "${RED}âŒ æ‰‹æœºç«¯distæ–‡ä»¶ç¼ºå¤±${NC}"
    echo "   è¯·å…ˆè¿è¡Œ: cd mobile && npm run build"
    exit 1
fi

echo
echo -e "${BLUE}ðŸ“¦ æž„å»ºäº§ç‰©ä¿¡æ¯${NC}"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

echo "ðŸ“± æ‰‹æœºç«¯ (mobile):"
echo "   index.html: $(stat -f%z mobile/dist/index.html 2>/dev/null || stat -c%s mobile/dist/index.html) bytes"
echo "   assetsæ•°é‡: $(find mobile/dist/assets -type f | wc -l) ä¸ªæ–‡ä»¶"

echo
echo -e "${YELLOW}âš ï¸  é‡è¦æç¤º${NC}"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo
echo "çŽ°åœ¨ä½ éœ€è¦åœ¨Sealos Web UIä¸­æ‰‹åŠ¨æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š"
echo
echo "1ï¸âƒ£  ç™»å½• https://cloud.sealos.io"
echo
echo "2ï¸âƒ£  è¿›å…¥ åº”ç”¨ç®¡ç† â†’ æ‰¾åˆ° 'mobile' åº”ç”¨"
echo
echo "3ï¸âƒ£  ç‚¹å‡»åº”ç”¨ â†’ é€‰æ‹© 'ç¼–è¾‘' æˆ– 'æ›´æ–°'"
echo
echo "4ï¸âƒ£  åˆ é™¤æ—§çš„distæ–‡ä»¶ï¼Œä¸Šä¼ æ–°çš„distæ–‡ä»¶å¤¹ï¼š"
echo "    æ¥æº: $(pwd)/mobile/dist/"
echo "    åŒ…å«: index.html å’Œ assets/ æ–‡ä»¶å¤¹"
echo
echo "5ï¸âƒ£  ç‚¹å‡» 'ä¿å­˜' æˆ– 'éƒ¨ç½²' æŒ‰é’®"
echo
echo "6ï¸âƒ£  ç­‰å¾… 2-3 åˆ†é’Ÿï¼ŒPodé‡å¯å®Œæ¯•"
echo
echo "7ï¸âƒ£  åœ¨æµè§ˆå™¨ä¸­æ¸…é™¤ç¼“å­˜å¹¶ç¡¬åˆ·æ–°:"
echo "    Windows/Linux: Ctrl+Shift+Delete â†’ æ¸…é™¤ â†’ Ctrl+F5"
echo "    Mac: Cmd+Shift+Delete â†’ æ¸…é™¤ â†’ Cmd+Shift+R"
echo
echo -e "${GREEN}âœ¨ æˆ–è€…ä½¿ç”¨kubectlå¿«é€Ÿæ›´æ–°:${NC}"
echo
echo "   # å¦‚æžœé…ç½®äº†kubectlè®¿é—®Sealos:"
echo "   kubectl delete configmap mobile-app-dist -n growark 2>/dev/null || true"
echo "   kubectl create configmap mobile-app-dist --from-file=mobile/dist/ -n growark"
echo "   kubectl rollout restart deployment mobile-app -n growark"
echo

echo -e "${BLUE}ðŸ“ æœ€æ–°åŠŸèƒ½æ¸…å•${NC}"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "âœ… Feature 2: å›¢é˜Ÿç³»ç»Ÿ (è¶…èƒ½è‹±é›„/å¤©æ‰å°‘å¹´/å­¦éœ¸æ— æ•Œ)"
echo "âœ… Feature 3: ä¸ªäººä¿¡æ¯ç¼–è¾‘ (åŒå‡»å¤´åƒç¼–è¾‘)"
echo "âœ… Feature 4: é»˜è®¤ç­çº§è®¾ç½® (é»„è€å¸ˆç­ç­‰)"
echo "âœ… Feature 5: ç§¯åˆ†ç®¡ç†UIé‡æž„"
echo "âœ… Feature 6: å­¦ç”Ÿç®¡ç†UIä¼˜åŒ–"
echo "âœ… Feature 7: æŒ‘æˆ˜åŽ†å²è®°å½• (è¿›è¡Œä¸­/è¿‡å¾€)"
echo "âœ… Feature 8: PKç³»ç»Ÿå¢žå¼º"
echo "âœ… Feature 9: è¿›åº¦æ¡ç³»ç»Ÿ"
echo "âœ… Feature 10: æ‰“å¡ç³»ç»Ÿä¼˜åŒ–"
echo

echo -e "${GREEN}âœ… æ‰€æœ‰æž„å»ºå·²å°±ç»ªï¼Œè¯·æŒ‰ç…§ä¸Šè¿°æ­¥éª¤åœ¨Sealos Web UIä¸­éƒ¨ç½²${NC}"
echo

# ç”Ÿæˆéƒ¨ç½²è¯´æ˜Žæ–‡ä»¶
cat > /tmp/mobile_update_steps.txt << 'STEPS'
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘          æ‰‹æœºç«¯å…¬ç½‘æ›´æ–°æ­¥éª¤ - Sealos Web UIç‰ˆæœ¬              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ã€æ­¥éª¤1ã€‘ç™»å½•SealosæŽ§åˆ¶å°
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼šhttps://cloud.sealos.io
ç”¨ä½ çš„è´¦æˆ·ç™»å½•

ã€æ­¥éª¤2ã€‘è¿›å…¥åº”ç”¨ç®¡ç†
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
åœ¨æŽ§åˆ¶å°ä¸»é¡µæ‰¾åˆ°"åº”ç”¨ç®¡ç†"æˆ–"æˆ‘çš„åº”ç”¨"
ç‚¹å‡»è¿›å…¥

ã€æ­¥éª¤3ã€‘æ‰¾åˆ°å¹¶æ‰“å¼€mobileåº”ç”¨
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
åœ¨åº”ç”¨åˆ—è¡¨ä¸­æ‰¾åˆ°"mobile"æˆ–"classroom-hero"åº”ç”¨
ç‚¹å‡»æ‰“å¼€åº”ç”¨è¯¦æƒ…

ã€æ­¥éª¤4ã€‘ç¼–è¾‘åº”ç”¨é…ç½®
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ç‚¹å‡»åº”ç”¨æ“ä½œèœå• â†’ "ç¼–è¾‘"æˆ–"æ›´æ–°"
æˆ–è€…æ‰¾åˆ°"é‡æ–°éƒ¨ç½²"é€‰é¡¹

ã€æ­¥éª¤5ã€‘æ›´æ–°é™æ€æ–‡ä»¶
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
åœ¨åº”ç”¨è®¾ç½®ä¸­æ‰¾åˆ°"æ–‡ä»¶"ã€"æž„å»º"æˆ–"æºä»£ç "éƒ¨åˆ†
åˆ é™¤æˆ–æ›¿æ¢æ—§çš„distæ–‡ä»¶å¤¹
ä¸Šä¼ æ–°çš„distæ–‡ä»¶å¤¹ï¼ˆä½ç½®ï¼š/home/devbox/project/mobile/dist/ï¼‰

å»ºè®®ï¼š
â€¢ ç¡®ä¿ä¸Šä¼ çš„æ˜¯å®Œæ•´çš„distæ–‡ä»¶å¤¹ç»“æž„
â€¢ åŒ…å«index.htmlå’Œassets/æ–‡ä»¶å¤¹
â€¢ ä¸è¦ä¸Šä¼ node_modulesæˆ–æºä»£ç 

ã€æ­¥éª¤6ã€‘ä¿å­˜å¹¶éƒ¨ç½²
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ç‚¹å‡»"ä¿å­˜"æˆ–"éƒ¨ç½²"æŒ‰é’®
ç­‰å¾…éƒ¨ç½²å®Œæˆï¼ˆé€šå¸¸éœ€è¦2-3åˆ†é’Ÿï¼‰
è§‚å¯Ÿåº”ç”¨çŠ¶æ€å˜ä¸º"Running"æˆ–"Active"

ã€æ­¥éª¤7ã€‘éªŒè¯éƒ¨ç½²å®Œæˆ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
åœ¨Sealosä¸­æŸ¥çœ‹åº”ç”¨çš„å…¬ç½‘åœ°å€ï¼ˆLoadBalancer IPæˆ–åŸŸåï¼‰
åœ¨æµè§ˆå™¨æ‰“å¼€è¿™ä¸ªåœ°å€

ã€æ­¥éª¤8ã€‘æ¸…é™¤ç¼“å­˜å¹¶ç¡¬åˆ·æ–°
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€å¼€å‘è€…å·¥å…· (æŒ‰F12)
æ‰¾åˆ°"Application"æˆ–"Storage"æ ‡ç­¾
æ¸…é™¤æ‰€æœ‰ç¼“å­˜ï¼ˆService Worker, Cache Storageç­‰ï¼‰

æˆ–è€…ç›´æŽ¥æ¸…é™¤æµè§ˆå™¨ç¼“å­˜ï¼š
  Windows/Linux:
    â€¢ æŒ‰ Ctrl+Shift+Delete
    â€¢ é€‰æ‹©"æ‰€æœ‰æ—¶é—´"
    â€¢ å‹¾é€‰"ç¼“å­˜çš„å›¾åƒå’Œæ–‡ä»¶"
    â€¢ ç‚¹å‡»"æ¸…é™¤æ•°æ®"
    â€¢ ç„¶åŽåœ¨ç½‘é¡µä¸ŠæŒ‰ Ctrl+F5 ç¡¬åˆ·æ–°

  Mac:
    â€¢ æŒ‰ Cmd+Shift+Delete
    â€¢ é€‰æ‹©"æ‰€æœ‰æ—¶é—´"
    â€¢ å‹¾é€‰ç¼“å­˜é€‰é¡¹
    â€¢ ç‚¹å‡»æ¸…é™¤
    â€¢ ç„¶åŽæŒ‰ Cmd+Shift+R ç¡¬åˆ·æ–°

æˆ–ä½¿ç”¨éšèº«çª—å£ï¼ˆä¸ä½¿ç”¨ä»»ä½•ç¼“å­˜ï¼‰

ã€æ­¥éª¤9ã€‘éªŒè¯æ–°åŠŸèƒ½
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
åˆ·æ–°å®Œæ¯•åŽï¼Œæµ‹è¯•ä»¥ä¸‹åŠŸèƒ½ï¼š

âœ“ åŒå‡»å­¦ç”Ÿå¤´åƒ â†’ ç¼–è¾‘å§“åæ¡†å‡ºçŽ°ï¼ˆFeature 3ï¼‰
âœ“ è¿›å…¥æŒ‘æˆ˜ â†’ çœ‹åˆ°"è¿›è¡Œä¸­"å’Œ"è¿‡å¾€æŒ‘æˆ˜"æ ‡ç­¾é¡µï¼ˆFeature 7ï¼‰
âœ“ æ‰“å¡ â†’ çœ‹åˆ°ç»¿è‰²æˆåŠŸæç¤ºï¼ˆFeature 10ï¼‰
âœ“ æŸ¥çœ‹å­¦ç”Ÿæˆ˜é˜Ÿ â†’ æ˜¾ç¤ºæ–°çš„å›¢é˜Ÿåç§°ï¼ˆFeature 2ï¼‰

ã€å¸¸è§é—®é¢˜ã€‘
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Q: éƒ¨ç½²åŽä»ç„¶çœ‹åˆ°æ—§åŠŸèƒ½ï¼Ÿ
A: è¿™æ˜¯æµè§ˆå™¨ç¼“å­˜é—®é¢˜
   è§£å†³ï¼šæŒ‰ Ctrl+Shift+Delete æ¸…é™¤ç¼“å­˜ï¼Œç„¶åŽ Ctrl+F5 ç¡¬åˆ·æ–°

Q: é¡µé¢æ˜¾ç¤º404æˆ–åŠ è½½é”™è¯¯ï¼Ÿ
A: å¯èƒ½æ˜¯éƒ¨ç½²æœªå®Œæˆæˆ–æ–‡ä»¶ä¸Šä¼ ä¸å®Œæ•´
   è§£å†³ï¼š
   1. ç­‰å¾…2-3åˆ†é’Ÿ
   2. æ£€æŸ¥Sealosä¸­åº”ç”¨çŠ¶æ€æ˜¯å¦ä¸º"Running"
   3. ç¡®ä¿distæ–‡ä»¶å¤¹å®Œæ•´ä¸Šä¼ 

Q: åŠŸèƒ½ä»ç„¶ä¸å¯ç”¨ï¼Ÿ
A: å¯èƒ½éœ€è¦é‡æ–°éƒ¨ç½²æˆ–æ¸…é™¤Service Worker
   è§£å†³ï¼š
   1. åœ¨æµè§ˆå™¨DevToolsä¸­æ¸…é™¤"Service Worker"
   2. æ¸…é™¤"Cache Storage"ä¸­çš„æ‰€æœ‰ç¼“å­˜
   3. å…³é—­æµè§ˆå™¨ï¼Œé‡æ–°æ‰“å¼€

ã€æˆåŠŸæ ‡å¿—ã€‘
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… é¡µé¢åŠ è½½æˆåŠŸï¼ˆæ— 404æˆ–ç™½å±ï¼‰
âœ… æ‰€æœ‰æ–°åŠŸèƒ½å¯ä»¥ä½¿ç”¨
âœ… æµè§ˆå™¨æŽ§åˆ¶å°æ²¡æœ‰é‡å¤§é”™è¯¯
âœ… APIè°ƒç”¨æ­£å¸¸ï¼ˆF12 â†’ Networkæ ‡ç­¾æ£€æŸ¥ï¼‰

STEPS

cat /tmp/mobile_update_steps.txt

echo
echo "ðŸ“– è¯¦ç»†æ­¥éª¤å·²ä¿å­˜åˆ°: /tmp/mobile_update_steps.txt"
echo
